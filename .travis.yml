language: node_js

stages:
  - test
git:
  depth: false
  
notifications:
  email: false

node_js:
  - 10


addons:
  sonarcloud:
    organization: "wvandolah" # the key of the org you chose at step #3


testService: &TEST_SERVICE
  install:
    - ls
    - cd backend
    - travis_retry npm install
    - cd -
    - cd tasks
    - travis_retry npm install
    - cd -

  script:
    - ls -d * */*
    - cd backend
    - npm run testCoverage
    - cd -
    - cd tasks
    - npm run testCoverage
    - cd -
    - sonar-scanner

jobs:
  include:
    - stage: test
      <<: *TEST_SERVICE
      name: "Test"